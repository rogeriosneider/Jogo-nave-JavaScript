<!doctype html>
<html>
    <script>
        class Sprite{
            constructor(ctx, imagem, x, y, largura, altura){
                this.ctx = ctx;
                this.imagem = imagem;
                this.x = x;
                this.y = y;
                this.destinoX = 0;
                this.largura = largura;
                this.altura = altura;
            }
            apaga(){
                this.ctx.clearRect(this.x, this.y, this.largura, this.altura); 
                        //clearRect apaga a imagem na posição informada, no tamanho informado;
                        //largura e altura são as dimenções de img da nave;
            }
            desenha(){
                this.ctx.drawImage(this.imagem, this.x, this.y);
            }
            move(){
                if(this.destinoX == this.x) return;
                this.apaga();
                if(this.destinoX > this.x) this.x += 2;
                else this.x -= 2;
                this.desenha();
            }
        }

        class Inimigo1 extends Sprite{
            constructor(ctx, imagem, x){
                super(ctx, imagem, x, 0, 34, 60);
            }
            move(){
                if(this.x >= 566){
                    this.destinoX = 0;
                }
                if(this.x <= 0){
                    this.destinoX = 566;
                }
                super.move();
            }
        }

        class Nave extends Sprite{
            constructor(ctx, imagem){
                super(ctx, imagem, 0, 350, 35, 44);
            }
            posicao(x){
                this.destinoX = x + (x%2);
                    //o +(x%2) é pra quando o x for impar transforma em par pra parar de tremer.
            }
        }

        function posicao(event){
            nave.posicao(event.offsetX);
        }
        
        let nave;
        let inimigos = [];

        function executaCiclo(){
            nave.move();
            for(let i=0; i<5; i++){
                inimigos[i].move();
            }
        }
        
        function iniciar(){
            //alert("game iniciado");
            let canvas = document.getElementById("gameMap");
            let ctx = canvas.getContext("2d");
                //ctx é o "contexto" do canvas, pra poder ser manipulado, criando no formato 2d;

            let naveImg = document.getElementById("nave");
            let inimigo1Img = document.getElementById("inimigo1")
            let inimigo2Img = document.getElementById("inimigo2");
            let tiroImg = document.getElementById("tiro");

            /*ctx.drawImage(naveImg, 100, 150);
            ctx.drawImage(inimigo1Img, 200, 150);
                //desenha no contexto a imagem escolhida, nos eixos x.horizontal e y.vertical respectivamente;*/

            nave = new Nave(ctx, naveImg);            
            for(let i=0; i<5; i++){
                let x=i*70;
                inimigos[i] = new Inimigo1(ctx, inimigo1Img, x);
            }

            intervalo = window.setInterval(executaCiclo,10);
                //10 é o intervalo de tempo medido em milissegundos; 100=1/10 e 1000=1s;
        }

    </script>
    <body onload="iniciar(); /*onload executa JS ao carregar body*/"> 
        <canvas id="gameMap" width="600" height="400" style="background-color: #ffffff; border: 1px solid #000000;"
        onmousemove="posicao(event)"></canvas>
        <img src="nave.png" id="nave">
        <img src="inimigo-fase1.png" id="inimigo1">
        <img src="inimigo-fase2.png" id="inimigo2">
        <img src="tiro.png" id="tiro">
    </body>
</html>